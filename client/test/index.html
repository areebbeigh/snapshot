<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>
  <!-- <a href="" id="a" target="_blank">test</a> -->
  <div id="tweet"></div>
  <img src="" id="ss" alt="">
  <div id="test2">
    <iframe src="https://www.facebook.com/plugins/post.php?href=https%3A%2F%2Fwww.facebook.com%2Feuphinx%2Fposts%2F111954209705484&width=500" width="500" height="191" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allow="encrypted-media"></iframe>
  </div>
  <div id="test">
    <blockquote>some more shit</blockquote> someshit
    <blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">There&#39;s a new Anime coming out that solely revolves around girls wearing wet tights.<br><br>Pack it up now people, we have reached peak culture. <a href="https://t.co/aPxxifEkoD">pic.twitter.com/aPxxifEkoD</a></p>&mdash; Gigguk (@GiggukAZ) <a href="https://twitter.com/GiggukAZ/status/1120332463623032833?ref_src=twsrc%5Etfw">April 22, 2019</a></blockquote>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.14.0/babel.min.js"></script>
  <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script> -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script> -->
  <script src="./html2canvas.min.js"></script>
  <script>
    run = () => {
      console.log('here')
      const node = document.getElementById('test2')
      domtoimage.toPng(node)
        .then(function (dataUrl) {
            var img = new Image();
            img.src = dataUrl;
            document.body.appendChild(img);
            console.log(img)
        })
        .catch(function (error) {
            console.error('oops, something went wrong!', error);
      });
    }

    function genScreenshot() {
      html2canvas(document.getElementById('tweet'), {
        allowTaint: true,
        useCORS: true,
        foreignObjectRendering: true,
        onrendered: function(canvas) {
          // $('#box1').html("");

          // if (navigator.userAgent.indexOf("MSIE ") > 0 || 
          //               navigator.userAgent.match(/Trident.*rv\:11\./)) 
          //       {
          //   var blob = canvas.msToBlob();
          //   window.navigator.msSaveBlob(blob,'Test file.png');
          // }
          // else {
          // }
          $('#ss').attr('src', canvas.toDataURL("image/png"));
          // $('#a').attr('href', canvas.toDataURL("image/png"));
          // $('#a').attr('download','screenshot.png');
          // $('#a')[0].click();
      }
    });
  } 
  </script>
</body>
</html>